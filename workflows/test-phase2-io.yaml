version: 2
metadata:
  name: Phase 2 I/O Test
  description: Test workflow for Phase 2 input/output system
nodes:
  - id: trigger-1
    type: trigger
    position:
      x: 100
      "y": 100
    data:
      label: Manual Trigger
      nodeType: trigger
      triggerType: manual
      inputs: []
      outputs:
        - name: timestamp
          type: string
          description: Trigger timestamp (ISO format)
        - name: type
          type: string
          description: Trigger type (manual, cron, etc.)
        - name: text
          type: string
          description: Input text (for manual triggers)
        - name: params
          type: json
          description: Additional trigger parameters
  - id: shell-1
    type: shell
    position:
      x: 300
      "y": 100
    data:
      label: Test stdout/stderr
      nodeType: shell
      script: |
        echo "This is stdout output"
        echo "This is stderr output" >&2
        echo "Exit code will be 0"
      inputs:
        - name: input
          type: any
          required: false
          description: Generic input for template interpolation
      outputs:
        - name: output
          type: string
          description: Combined stdout output
        - name: stdout
          type: string
          description: Standard output
        - name: stderr
          type: string
          description: Standard error
        - name: exitCode
          type: number
          description: Exit code (0 = success)
  - id: shell-2
    type: shell
    position:
      x: 500
      "y": 100
    data:
      label: Use trigger text
      nodeType: shell
      script: |
        echo "Received from trigger: {{ input }}"
      inputs:
        - name: input
          type: any
          required: false
          description: Generic input for template interpolation
      outputs:
        - name: output
          type: string
          description: Combined stdout output
        - name: stdout
          type: string
          description: Standard output
        - name: stderr
          type: string
          description: Standard error
        - name: exitCode
          type: number
          description: Exit code (0 = success)
  - id: shell-3
    type: shell
    position:
      x: 700
      "y": 100
    data:
      label: Use shell stdout
      nodeType: shell
      script: |
        echo "Previous stdout was:"
        echo "{{ input }}"
      inputs:
        - name: input
          type: any
          required: false
          description: Generic input for template interpolation
      outputs:
        - name: output
          type: string
          description: Combined stdout output
        - name: stdout
          type: string
          description: Standard output
        - name: stderr
          type: string
          description: Standard error
        - name: exitCode
          type: number
          description: Exit code (0 = success)
  - id: shell-4
    type: shell
    position:
      x: 900
      "y": 100
    data:
      label: Final output
      nodeType: shell
      script: |
        echo "Received from previous shell:"
        echo "{{ input }}"
        echo "All tests passed!"
      inputs:
        - name: input
          type: any
          required: false
          description: Generic input for template interpolation
      outputs:
        - name: output
          type: string
          description: Combined stdout output
        - name: stdout
          type: string
          description: Standard output
        - name: stderr
          type: string
          description: Standard error
        - name: exitCode
          type: number
          description: Exit code (0 = success)
edges:
  - id: e1
    source: trigger-1
    target: shell-1
    sourceHandle: output:text
    targetHandle: input:input
  - id: e2
    source: trigger-1
    target: shell-2
    sourceHandle: output:text
    targetHandle: input:input
  - id: e3
    source: shell-1
    target: shell-3
    sourceHandle: output:stdout
    targetHandle: input:input
  - id: e4
    source: shell-3
    target: shell-4
    sourceHandle: output:stdout
    targetHandle: input:input
